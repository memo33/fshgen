package fshgen

import ps.tricerato.pureimage._

object Curves {

  trait Curve {
    val red, green, blue: Array[Double]
    def apply(img: Image[RGBA]): Image[RGBA] = new Image[RGBA] {
      def width = img.width; def height = img.height
      def apply(x: Int, y: Int) = {
        val p = img(x, y)
        RGBA((p.alpha & 0xff) << 24 |
          (255 * blue(p.blue & 0xff)).toInt << 16 |
          (255 * green(p.green & 0xff)).toInt << 8 |
          (255 * red(p.red & 0xff)).toInt)
      }
    }
  }

  object Darkening extends Curve {
    val red = Array(0.000000, 0.003591, 0.007181, 0.010772, 0.014361, 0.017950, 0.021538, 0.025125, 0.028711, 0.032296, 0.035878, 0.039460, 0.043039, 0.046616, 0.050191, 0.053763, 0.057333, 0.060899, 0.064463, 0.068024, 0.071581, 0.075135, 0.078686, 0.082232, 0.085774, 0.089312, 0.092846, 0.096375, 0.099900, 0.103419, 0.106934, 0.110443, 0.113947, 0.117445, 0.120937, 0.124424, 0.127904, 0.131378, 0.134845, 0.138306, 0.141760, 0.145207, 0.148647, 0.152079, 0.155504, 0.158921, 0.162331, 0.165732, 0.169125, 0.172509, 0.175885, 0.179688, 0.183039, 0.186371, 0.189685, 0.192981, 0.196259, 0.199522, 0.202770, 0.206003, 0.209222, 0.212429, 0.215624, 0.218808, 0.221982, 0.225146, 0.228302, 0.231450, 0.234592, 0.237727, 0.240857, 0.243983, 0.247105, 0.250225, 0.253342, 0.256459, 0.259576, 0.262693, 0.265812, 0.268933, 0.272058, 0.275186, 0.278320, 0.281459, 0.284605, 0.287758, 0.290919, 0.294090, 0.297270, 0.300461, 0.303664, 0.306879, 0.310108, 0.313350, 0.316608, 0.319881, 0.323171, 0.326479, 0.329804, 0.333149, 0.336514, 0.339900, 0.343750, 0.347182, 0.350634, 0.354106, 0.357596, 0.361104, 0.364630, 0.368173, 0.371731, 0.375304, 0.378892, 0.382493, 0.386107, 0.389734, 0.393371, 0.397019, 0.400678, 0.404345, 0.408021, 0.411704, 0.415394, 0.419091, 0.422792, 0.426499, 0.430210, 0.433923, 0.437639, 0.441357, 0.445076, 0.448795, 0.452514, 0.456231, 0.459947, 0.463659, 0.467369, 0.471074, 0.474774, 0.478468, 0.482156, 0.485836, 0.489509, 0.493173, 0.496828, 0.500472, 0.504106, 0.507728, 0.511337, 0.514933, 0.518516, 0.522084, 0.525636, 0.527344, 0.530878, 0.534408, 0.537933, 0.541453, 0.544969, 0.548481, 0.551988, 0.555490, 0.558989, 0.562483, 0.565973, 0.569458, 0.572940, 0.576417, 0.579891, 0.583360, 0.586826, 0.590287, 0.593745, 0.597199, 0.600650, 0.604096, 0.607540, 0.610979, 0.614415, 0.617848, 0.621277, 0.624703, 0.628125, 0.631545, 0.634961, 0.638374, 0.641783, 0.645190, 0.648594, 0.651995, 0.655393, 0.658788, 0.662180, 0.665570, 0.668957, 0.672341, 0.675723, 0.679102, 0.682479, 0.685853, 0.689225, 0.692595, 0.695962, 0.699327, 0.703125, 0.706484, 0.709839, 0.713190, 0.716536, 0.719879, 0.723217, 0.726551, 0.729882, 0.733208, 0.736531, 0.739850, 0.743166, 0.746479, 0.749788, 0.753094, 0.756396, 0.759696, 0.762992, 0.766286, 0.769577, 0.772865, 0.776150, 0.779433, 0.782714, 0.785992, 0.789267, 0.792541, 0.795812, 0.799082, 0.802349, 0.805615, 0.808879, 0.812141, 0.815402, 0.818661, 0.821918, 0.825175, 0.828430, 0.831684, 0.834937, 0.838189, 0.841440, 0.844690, 0.847939, 0.851188, 0.854437, 0.857685, 0.860932, 0.864179, 0.867426, 0.871094)
    val green = Array(0.000000, 0.003332, 0.006663, 0.009995, 0.013327, 0.016660, 0.019992, 0.023325, 0.026659, 0.029993, 0.033328, 0.036663, 0.039999, 0.043336, 0.046674, 0.050013, 0.053353, 0.056694, 0.060036, 0.063380, 0.066724, 0.070070, 0.073418, 0.076767, 0.080118, 0.083470, 0.086824, 0.090180, 0.093537, 0.096897, 0.100258, 0.103622, 0.106988, 0.110355, 0.113726, 0.117098, 0.120473, 0.123851, 0.127230, 0.130613, 0.133998, 0.137386, 0.140777, 0.144171, 0.147567, 0.150967, 0.154370, 0.157776, 0.161185, 0.164597, 0.168013, 0.171875, 0.175300, 0.178732, 0.182170, 0.185615, 0.189066, 0.192523, 0.195985, 0.199453, 0.202925, 0.206402, 0.209883, 0.213369, 0.216858, 0.220350, 0.223846, 0.227345, 0.230847, 0.234350, 0.237856, 0.241364, 0.244873, 0.248383, 0.251895, 0.255406, 0.258919, 0.262431, 0.265943, 0.269455, 0.272966, 0.276475, 0.279984, 0.283491, 0.286995, 0.290498, 0.293998, 0.297495, 0.300990, 0.304481, 0.307968, 0.311451, 0.314930, 0.318405, 0.321875, 0.325339, 0.328799, 0.332253, 0.335700, 0.339142, 0.342577, 0.346005, 0.347656, 0.351076, 0.354491, 0.357903, 0.361311, 0.364715, 0.368116, 0.371513, 0.374907, 0.378298, 0.381686, 0.385071, 0.388452, 0.391831, 0.395207, 0.398581, 0.401952, 0.405321, 0.408687, 0.412051, 0.415412, 0.418772, 0.422130, 0.425486, 0.428840, 0.432193, 0.435544, 0.438893, 0.442241, 0.445588, 0.448934, 0.452278, 0.455622, 0.458965, 0.462307, 0.465648, 0.468989, 0.472329, 0.475669, 0.479009, 0.482348, 0.485688, 0.489027, 0.492367, 0.495706, 0.499046, 0.502387, 0.505728, 0.509069, 0.512411, 0.515754, 0.519531, 0.522875, 0.526218, 0.529560, 0.532900, 0.536239, 0.539578, 0.542915, 0.546251, 0.549587, 0.552921, 0.556255, 0.559587, 0.562919, 0.566250, 0.569581, 0.572910, 0.576239, 0.579567, 0.582895, 0.586221, 0.589548, 0.592874, 0.596199, 0.599523, 0.602848, 0.606172, 0.609495, 0.612818, 0.616141, 0.619463, 0.622785, 0.626107, 0.629429, 0.632751, 0.636072, 0.639393, 0.642715, 0.646036, 0.649357, 0.652678, 0.655999, 0.659321, 0.662642, 0.665964, 0.669285, 0.672607, 0.675929, 0.679252, 0.682574, 0.687500, 0.690823, 0.694146, 0.697469, 0.700792, 0.704114, 0.707436, 0.710758, 0.714080, 0.717402, 0.720723, 0.724045, 0.727366, 0.730687, 0.734007, 0.737328, 0.740648, 0.743969, 0.747289, 0.750609, 0.753929, 0.757248, 0.760568, 0.763888, 0.767207, 0.770526, 0.773845, 0.777164, 0.780483, 0.783802, 0.787121, 0.790439, 0.793758, 0.797076, 0.800395, 0.803713, 0.807031, 0.810349, 0.813667, 0.816985, 0.820303, 0.823621, 0.826939, 0.830257, 0.833575, 0.836892, 0.840210, 0.843528, 0.846845, 0.850163, 0.853481, 0.856798, 0.859375)
    val blue = Array(0.000000, 0.003580, 0.007160, 0.010739, 0.014319, 0.017897, 0.021475, 0.025052, 0.028628, 0.032202, 0.035775, 0.039347, 0.042917, 0.046486, 0.050052, 0.053616, 0.057178, 0.060738, 0.064294, 0.067849, 0.071400, 0.074948, 0.078494, 0.082036, 0.085574, 0.089109, 0.092640, 0.096167, 0.099690, 0.103209, 0.106723, 0.110233, 0.113738, 0.117239, 0.120734, 0.124225, 0.127710, 0.131189, 0.134663, 0.138132, 0.141594, 0.145050, 0.148501, 0.151945, 0.155382, 0.158813, 0.162237, 0.165654, 0.169064, 0.172466, 0.175862, 0.179688, 0.183063, 0.186426, 0.189775, 0.193111, 0.196435, 0.199747, 0.203049, 0.206340, 0.209621, 0.212892, 0.216154, 0.219409, 0.222655, 0.225894, 0.229126, 0.232352, 0.235572, 0.238787, 0.241997, 0.245203, 0.248406, 0.251605, 0.254803, 0.257998, 0.261191, 0.264384, 0.267577, 0.270769, 0.273963, 0.277157, 0.280354, 0.283553, 0.286754, 0.289959, 0.293168, 0.296381, 0.299600, 0.302824, 0.306054, 0.309290, 0.312534, 0.315786, 0.319045, 0.322314, 0.325592, 0.328879, 0.332177, 0.335486, 0.338806, 0.342139, 0.343750, 0.347097, 0.350451, 0.353809, 0.357173, 0.360543, 0.363917, 0.367297, 0.370682, 0.374071, 0.377465, 0.380864, 0.384267, 0.387674, 0.391085, 0.394501, 0.397920, 0.401344, 0.404770, 0.408201, 0.411635, 0.415072, 0.418512, 0.421955, 0.425402, 0.428850, 0.432302, 0.435756, 0.439213, 0.442671, 0.446132, 0.449595, 0.453060, 0.456527, 0.459995, 0.463465, 0.466936, 0.470408, 0.473882, 0.477356, 0.480831, 0.484307, 0.487784, 0.491261, 0.494739, 0.498217, 0.501695, 0.505172, 0.508650, 0.512128, 0.515605, 0.519531, 0.523012, 0.526501, 0.529998, 0.533503, 0.537015, 0.540534, 0.544059, 0.547590, 0.551127, 0.554668, 0.558214, 0.561764, 0.565318, 0.568876, 0.572436, 0.575998, 0.579563, 0.583129, 0.586696, 0.590263, 0.593831, 0.597399, 0.600965, 0.604531, 0.608095, 0.611658, 0.615218, 0.618774, 0.622328, 0.625878, 0.629424, 0.632965, 0.636501, 0.640031, 0.643556, 0.647074, 0.650585, 0.654090, 0.657586, 0.661074, 0.664554, 0.668025, 0.671486, 0.674937, 0.678378, 0.681809, 0.685228, 0.688635, 0.692031, 0.695414, 0.699219, 0.702576, 0.705924, 0.709264, 0.712595, 0.715918, 0.719233, 0.722540, 0.725839, 0.729131, 0.732415, 0.735692, 0.738963, 0.742226, 0.745482, 0.748732, 0.751976, 0.755213, 0.758445, 0.761671, 0.764891, 0.768105, 0.771315, 0.774519, 0.777718, 0.780913, 0.784103, 0.787288, 0.790470, 0.793647, 0.796820, 0.799990, 0.803156, 0.806319, 0.809479, 0.812635, 0.815789, 0.818940, 0.822089, 0.825235, 0.828379, 0.831522, 0.834662, 0.837801, 0.840939, 0.844075, 0.847210, 0.850344, 0.853478, 0.856611, 0.859743, 0.863281)
  }

  object Brightening extends Curve {
    val red = Array(0.000000, 0.004406, 0.008812, 0.013218, 0.017625, 0.022033, 0.026442, 0.030853, 0.035265, 0.039679, 0.044095, 0.048513, 0.052934, 0.057357, 0.061784, 0.066213, 0.070646, 0.075083, 0.079524, 0.083968, 0.088417, 0.092871, 0.097329, 0.101792, 0.106261, 0.110735, 0.115215, 0.119700, 0.124192, 0.128690, 0.133195, 0.137706, 0.142225, 0.146751, 0.151284, 0.155825, 0.160374, 0.164932, 0.169498, 0.174072, 0.178655, 0.183248, 0.187849, 0.192460, 0.197081, 0.203125, 0.207780, 0.212465, 0.217178, 0.221918, 0.226682, 0.231470, 0.236279, 0.241108, 0.245956, 0.250819, 0.255698, 0.260589, 0.265492, 0.270404, 0.275324, 0.280250, 0.285181, 0.290115, 0.295049, 0.299983, 0.304915, 0.309843, 0.314765, 0.319680, 0.324585, 0.329480, 0.334362, 0.339230, 0.344082, 0.348917, 0.353732, 0.358526, 0.363297, 0.368044, 0.372765, 0.377458, 0.382122, 0.386754, 0.391354, 0.395919, 0.400447, 0.402344, 0.406823, 0.411275, 0.415701, 0.420102, 0.424478, 0.428831, 0.433162, 0.437472, 0.441762, 0.446033, 0.450286, 0.454523, 0.458744, 0.462950, 0.467142, 0.471322, 0.475491, 0.479649, 0.483798, 0.487938, 0.492072, 0.496199, 0.500321, 0.504439, 0.508554, 0.512668, 0.516780, 0.520893, 0.525007, 0.529123, 0.533243, 0.537368, 0.541497, 0.545634, 0.549778, 0.553931, 0.558094, 0.562268, 0.566453, 0.570652, 0.574865, 0.579092, 0.583336, 0.587598, 0.591877, 0.596176, 0.601562, 0.605901, 0.610247, 0.614599, 0.618958, 0.623323, 0.627695, 0.632073, 0.636457, 0.640847, 0.645244, 0.649646, 0.654055, 0.658469, 0.662889, 0.667315, 0.671747, 0.676184, 0.680626, 0.685074, 0.689527, 0.693985, 0.698449, 0.702917, 0.707391, 0.711869, 0.716353, 0.720841, 0.725333, 0.729830, 0.734332, 0.738838, 0.743349, 0.747864, 0.752382, 0.756906, 0.761433, 0.765964, 0.770498, 0.775037, 0.779579, 0.784125, 0.788675, 0.793228, 0.797784, 0.800781, 0.805345, 0.809916, 0.814494, 0.819078, 0.823670, 0.828267, 0.832871, 0.837481, 0.842097, 0.846719, 0.851346, 0.855978, 0.860616, 0.865259, 0.869907, 0.874560, 0.879217, 0.883878, 0.888544, 0.893214, 0.897887, 0.902564, 0.907245, 0.911929, 0.916617, 0.921307, 0.926000, 0.930696, 0.935395, 0.940095, 0.944798, 0.949503, 0.954210, 0.958918, 0.963628, 0.968340, 0.973052, 0.977765, 0.982479, 0.987194, 0.991909, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000)
    val green = Array(0.000000, 0.004741, 0.009482, 0.014222, 0.018962, 0.023701, 0.028439, 0.033176, 0.037912, 0.042646, 0.047379, 0.052110, 0.056839, 0.061566, 0.066290, 0.071012, 0.075732, 0.080448, 0.085161, 0.089871, 0.094578, 0.099281, 0.103980, 0.108675, 0.113366, 0.118053, 0.122735, 0.127412, 0.132085, 0.136752, 0.141415, 0.146072, 0.150723, 0.155368, 0.160008, 0.164641, 0.169268, 0.173889, 0.178503, 0.183110, 0.187710, 0.192302, 0.196888, 0.203125, 0.207690, 0.212245, 0.216789, 0.221323, 0.225848, 0.230363, 0.234870, 0.239368, 0.243858, 0.248341, 0.252817, 0.257287, 0.261750, 0.266207, 0.270659, 0.275107, 0.279550, 0.283988, 0.288424, 0.292856, 0.297285, 0.301712, 0.306137, 0.310561, 0.314983, 0.319406, 0.323827, 0.328250, 0.332673, 0.337097, 0.341522, 0.345950, 0.350380, 0.354813, 0.359249, 0.363688, 0.368132, 0.372581, 0.377034, 0.381493, 0.385958, 0.390429, 0.394907, 0.399392, 0.402344, 0.406837, 0.411331, 0.415825, 0.420319, 0.424813, 0.429308, 0.433804, 0.438300, 0.442797, 0.447294, 0.451793, 0.456293, 0.460794, 0.465297, 0.469801, 0.474306, 0.478813, 0.483322, 0.487833, 0.492345, 0.496860, 0.501377, 0.505896, 0.510417, 0.514942, 0.519468, 0.523998, 0.528530, 0.533065, 0.537603, 0.542144, 0.546689, 0.551237, 0.555788, 0.560343, 0.564902, 0.569464, 0.574030, 0.578601, 0.583175, 0.587754, 0.592337, 0.596924, 0.601562, 0.606162, 0.610770, 0.615387, 0.620013, 0.624646, 0.629287, 0.633935, 0.638590, 0.643251, 0.647917, 0.652589, 0.657265, 0.661946, 0.666630, 0.671318, 0.676009, 0.680702, 0.685397, 0.690094, 0.694792, 0.699490, 0.704189, 0.708887, 0.713585, 0.718281, 0.722976, 0.727668, 0.732358, 0.737045, 0.741729, 0.746408, 0.751083, 0.755754, 0.760418, 0.765077, 0.769730, 0.774376, 0.779015, 0.783647, 0.788270, 0.792885, 0.797491, 0.800781, 0.805373, 0.809961, 0.814544, 0.819122, 0.823697, 0.828267, 0.832834, 0.837397, 0.841955, 0.846511, 0.851062, 0.855610, 0.860155, 0.864697, 0.869235, 0.873771, 0.878303, 0.882833, 0.887360, 0.891884, 0.896406, 0.900925, 0.905442, 0.909957, 0.914470, 0.918981, 0.923490, 0.927997, 0.932502, 0.937006, 0.941509, 0.946010, 0.950510, 0.955008, 0.959506, 0.964002, 0.968498, 0.972993, 0.977488, 0.981982, 0.986475, 0.990968, 0.995461, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000)
    val blue = Array(0.000000, 0.004406, 0.008812, 0.013218, 0.017625, 0.022033, 0.026442, 0.030853, 0.035265, 0.039679, 0.044095, 0.048513, 0.052934, 0.057357, 0.061784, 0.066213, 0.070646, 0.075083, 0.079524, 0.083968, 0.088417, 0.092871, 0.097329, 0.101792, 0.106261, 0.110735, 0.115215, 0.119700, 0.124192, 0.128690, 0.133195, 0.137706, 0.142225, 0.146751, 0.151284, 0.155825, 0.160374, 0.164932, 0.169498, 0.174072, 0.178655, 0.183248, 0.187849, 0.192460, 0.197081, 0.203125, 0.207777, 0.212455, 0.217158, 0.221882, 0.226629, 0.231395, 0.236180, 0.240983, 0.245802, 0.250635, 0.255482, 0.260341, 0.265210, 0.270089, 0.274975, 0.279869, 0.284767, 0.289670, 0.294575, 0.299481, 0.304387, 0.309292, 0.314194, 0.319091, 0.323983, 0.328869, 0.333746, 0.338613, 0.343470, 0.348314, 0.353145, 0.357960, 0.362760, 0.367541, 0.372304, 0.377046, 0.381767, 0.386465, 0.391138, 0.395785, 0.400406, 0.402344, 0.406930, 0.411501, 0.416057, 0.420598, 0.425125, 0.429638, 0.434139, 0.438627, 0.443102, 0.447566, 0.452019, 0.456461, 0.460893, 0.465316, 0.469729, 0.474133, 0.478529, 0.482917, 0.487298, 0.491672, 0.496040, 0.500402, 0.504759, 0.509111, 0.513458, 0.517802, 0.522142, 0.526479, 0.530814, 0.535147, 0.539478, 0.543808, 0.548138, 0.552468, 0.556798, 0.561130, 0.565462, 0.569797, 0.574134, 0.578474, 0.582817, 0.587164, 0.591515, 0.595871, 0.601562, 0.605923, 0.610274, 0.614614, 0.618946, 0.623269, 0.627584, 0.631892, 0.636193, 0.640489, 0.644779, 0.649064, 0.653346, 0.657624, 0.661899, 0.666172, 0.670443, 0.674714, 0.678984, 0.683255, 0.687526, 0.691799, 0.696075, 0.700353, 0.704635, 0.708921, 0.713212, 0.717508, 0.721810, 0.726119, 0.730435, 0.734759, 0.739092, 0.743433, 0.747785, 0.752147, 0.756520, 0.760905, 0.765302, 0.769712, 0.774136, 0.778574, 0.783027, 0.787495, 0.791980, 0.796481, 0.800781, 0.805315, 0.809864, 0.814427, 0.819003, 0.823593, 0.828197, 0.832813, 0.837441, 0.842082, 0.846734, 0.851397, 0.856072, 0.860757, 0.865453, 0.870158, 0.874873, 0.879597, 0.884330, 0.889072, 0.893822, 0.898580, 0.903345, 0.908117, 0.912896, 0.917681, 0.922473, 0.927270, 0.932072, 0.936880, 0.941692, 0.946508, 0.951328, 0.956152, 0.960979, 0.965809, 0.970641, 0.975476, 0.980312, 0.985150, 0.989989, 0.994828, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000)
  }
}
